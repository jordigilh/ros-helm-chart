{{/*
AWS Configuration for boto3 S3 client
Forces path-style addressing for S3-compatible storage (NooBaa/Ceph RGW/MinIO)

This is critical for pre-signed URL generation:
- Virtual-hosted style: https://BUCKET.s3.endpoint/path (causes signature mismatches)
- Path style: https://s3.endpoint/BUCKET/path (works correctly with S3-compatible storage)

The ROS processor receives pre-signed URLs from Koku. If Koku generates URLs in
virtual-hosted style, the signatures will not validate correctly on NooBaa/Ceph RGW.
*/}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "cost-onprem.fullname" . }}-aws-config
  labels:
    {{- include "cost-onprem.koku.labels" . | nindent 4 }}
data:
  config: |
    [default]
    region = us-east-1
    s3 =
      signature_version = s3v4
      addressing_style = path
